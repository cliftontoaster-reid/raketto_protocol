syntax = "proto3";

package org.archprotogens.raketto.auth.v1;

import "google/protobuf/timestamp.proto";
import "org/archprotogens/raketto/security/v1/security.proto";

option go_package = "raketto/auth/v1";

message AuthToken {
  string token = 1;
  string refresh_token = 2;

  google.protobuf.Timestamp expires_at = 3;
  google.protobuf.Timestamp refresh_expires_at = 4;
}

message LoginRequest {
  string email = 1;
  string password = 2;
}

message LoginResponse {
  oneof result {
    AuthToken auth_token = 1;
    org.archprotogens.raketto.security.v1.VerificationRequest verification_request = 2;
  }
}

message RefreshTokenRequest {
  string refresh_token = 1;
}

service AuthService {
  rpc Login(LoginRequest) returns (LoginResponse);
  rpc EndLoginWithVerification(org.archprotogens.raketto.security.v1.VerificationReply) returns (LoginResponse);
  rpc RefreshToken(RefreshTokenRequest) returns (AuthToken);
}
